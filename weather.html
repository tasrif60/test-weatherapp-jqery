<!DOCTYPE html>
<html>
<body>

<p>Click the button to get your current condition.</p>

<button class="music-player1">Weather Music</button>

<button id="speak">Current Temperature</button>

<button id="time">Current Time and Date</button>
<p id="demo"></p>

<div>
	<p id="temp">
	</p>
	<p id="weatherType">
	</p>
	<p id="isDay">
	</p>
</div>

<div>
	<audio class="music" id="rainy" controls preload="none" hidden> 
		<source src="rain.wav" type="audio/mpeg">
	</audio>
	<audio class="music" id="sunny" controls preload="none" hidden> 
		<source src="Sunny.mp3" type="audio/mpeg">
	</audio>
	<audio class="music" id="windy" controls preload="none" hidden> 
		<source src="Wind.wav" type="audio/mpeg">
	</audio>
	<audio class="Storm" id="cloudy" controls preload="none" hidden> 
		<source src="Storm.mp3" type="audio/mpeg">
	</audio>

</div>

<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>

<script>
var x = document.getElementById("demo");
var flag;
var weatherId;
var rainy = [18, 12];
var sunny = [1,2,3,4,5,6, 23, 20, 21, 17,16,14,30];
var windy = [38, 37,36,35,34,33,32, 39,40,41,42];
var cloudy = [7, 8,11, 13, 15, 19,38, 43, 44];
var week = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
const msg = new SpeechSynthesisUtterance();
let voices = [];
window.onload=function(){
     getLocation();
}

function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else { 
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}

$('#time').click(() => {
	var d = new Date();
	//msg.voice = speechSynthesis.getVoices().find(voice => voice.name === 'Google US English');
	msg.text = "It's " + week[d.getDay()] + "and the time is" + (d.getHours()%12) + d.getMinutes() + (d.getHours()/12 > 0 ? "PM" : "AM");
	toggle();
})

function selectVoice() {}

$('#speak').click(() => {
	
	var x = document.getElementById('temp').textContent;
	//msg.voice = speechSynthesis.getVoices().find(voice => voice.name === 'Google US English');
	msg.text = "It's " + x + " outside.";
	toggle();
})

function toggle() {
	speechSynthesis.cancel();
	speechSynthesis.speak(msg);
}

$('.music-player1').click(function() {
	
	if(jQuery.inArray(weatherId, rainy) !== -1) {
		playOrPauseMusic("rainy");
	}
	else if(jQuery.inArray(weatherId, sunny) !== -1) {
		playOrPauseMusic("sunny");
	}
	else if(jQuery.inArray(weatherId, windy) !== -1) {
		playOrPauseMusic("windy");
	}
	else {
		playOrPauseMusic("cloudy");
	}
	

});

function playOrPauseMusic(id) {
	var flag = document.getElementById(id).paused;
	if(flag) {
		$('#'+ id).trigger('play');
	}
	else {
		$('#' + id).trigger('pause');
	}
		
}


function showPosition(position) {
  var api_url = 'http://dataservice.accuweather.com/locations/v1/cities/geoposition/search?apikey='
  var key = '3t7EAkvBFdWqQPHgLKAIIQJ6UyGfBVxb';
  var locationKey = '28081'
  
	$.get( api_url + key + "&q=" + position.coords.latitude + "%2C" + position.coords.longitude, function( data ) {
		
		var locationApi = "http://dataservice.accuweather.com/currentconditions/v1/";
		var locationKey = data.Key;
		$.get( locationApi + locationKey + "?apikey=" + key, function( result ) {
			$('#temp').html(result[0].Temperature.Metric.Value + '\xB0' + result[0].Temperature.Metric.Unit);
			$('#weatherType').html(result[0].WeatherText);
			if(result[0].IsDayTime){
				$('#isDay').html("Day");
			} else{
				$('#isDay').html("Night");
			}
			weatherId = result[0].WeatherIcon;
		});

	});
}

</script>
</body>
</html>